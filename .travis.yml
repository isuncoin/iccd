sudo: false
language: cpp

compiler:
  - clang
  - gcc

env:
  global:
    # Maintenance note: to move to a new version
    # of boost, update both BOOST_ROOT and BOOST_URL.
    # Note that for simplicity, BOOST_ROOT's final
    # namepart must match the folder name internal
    # to boost's .tar.gz.
    - BOOST_ROOT=$HOME/boost_1_59_0
    - BOOST_URL='http://downloads.sourceforge.net/project/boost/boost/1.59.0/boost_1_59_0.tar.gz?r=http%3A%2F%2Fsourceforge.net%2Fprojects%2Fboost%2Ffiles%2Fboost%2F1.59.0%2Fboost_1_59_0.tar.gz%2Fdownload&ts=1441761349&use_mirror=skylineservers'
    # We need gcc >= 4.8 for some c++11 features.
    # To change, also change the packages: entry.
    # Env vars are not translated there.
    - GCC_VER=4.8
  matrix:
    - TARGET=coverage
    - TARGET=debug
    - TARGET=debug.nounity
    # We can specify any combination of builds here, for example, to
    # include release builds, too, uncomment the following lines.
    #- TARGET=release
    #- TARGET=release.nounity
matrix:
  exclude:
    # Because gcov won't work (easily) with clang
    - env: TARGET=coverage
      compiler: clang
    # Because coverage target is basically debug + --coverage flags
    - env: TARGET=debug
      compiler: gcc

addons:
  apt:
    sources:
    - ubuntu-toolchain-r-test
    packages:
    - python-software-properties
    # See also GCC_VER.
    - g++-4.8
    - gcc-4.8
    - protobuf-compiler
    - libprotobuf-dev
    - libssl-dev
    # Not available, but not needed
    # - exuberant-ctags
    - binutils-gold
    # Provides a backtrace if the unittests crash
    - gdb

cache:
  directories:
  - $BOOST_ROOT

before_install:
  - bin/ci/ubuntu/install-dependencies.sh

script:
  - bin/ci/ubuntu/build-and-test.sh

notifications:
  email:
    false
  irc:
    channels:
      - "chat.freenode.net#ripple-dev"
